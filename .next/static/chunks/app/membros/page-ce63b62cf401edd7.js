(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{7322:function(e,s,a){Promise.resolve().then(a.bind(a,3262))},9376:function(e,s,a){"use strict";var o=a(5475);a.o(o,"useParams")&&a.d(s,{useParams:function(){return o.useParams}}),a.o(o,"useRouter")&&a.d(s,{useRouter:function(){return o.useRouter}}),a.o(o,"useSearchParams")&&a.d(s,{useSearchParams:function(){return o.useSearchParams}})},3262:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return d}});var o=a(7437),r=a(2265),t=a(9376),i=a(7648),c=a(4933);function n(){let e=(0,t.useSearchParams)().get("comissao_id"),[s,a]=(0,r.useState)([]),[n,d]=(0,r.useState)([]),[m,l]=(0,r.useState)(e||""),[h,p]=(0,r.useState)(!0),[u,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let{data:e}=await c.h.getComissoes();d(e)}catch(e){console.error("Erro ao carregar comiss\xf5es:",e),x("N\xe3o foi poss\xedvel carregar as comiss\xf5es. Tente novamente mais tarde.")}})()},[]),(0,r.useEffect)(()=>{(async()=>{try{p(!0);let{data:e}=await c.h.getMembros(m||null);a(e)}catch(e){console.error("Erro ao carregar membros:",e),x("N\xe3o foi poss\xedvel carregar os membros. Tente novamente mais tarde.")}finally{p(!1)}})()},[m]);let j=s.reduce((e,s)=>{let a=s.comissao_id;return e[a]||(e[a]={id:a,nome:s.comissao_nome,descricao:s.comissao_descricao,area_atuacao:s.area_atuacao,membros:[]}),e[a].membros.push(s),e},{});return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"mb-8 flex flex-col md:flex-row justify-between items-start md:items-center",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Membros de Comiss\xf5es"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Visualize os membros de todas as comiss\xf5es da OAB-GO"})]}),(0,o.jsx)("div",{className:"mt-4 md:mt-0",children:(0,o.jsx)(i.default,{href:"/membros/novo",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors",children:"+ Adicionar Membro"})})]}),(0,o.jsxs)("div",{className:"mb-6 bg-white p-4 rounded-md shadow-sm",children:[(0,o.jsx)("div",{className:"text-gray-700 mb-2",children:"Filtrar por comiss\xe3o:"}),(0,o.jsxs)("select",{value:m,onChange:e=>{l(e.target.value)},className:"w-full md:w-64 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,o.jsx)("option",{value:"",children:"Todas as comiss\xf5es"}),n.map(e=>(0,o.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),h?(0,o.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md text-center py-12",children:(0,o.jsx)("p",{className:"text-gray-500",children:"Carregando membros..."})}):u?(0,o.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md text-center py-12",children:(0,o.jsx)("p",{className:"text-red-500",children:u})}):0===Object.keys(j).length?(0,o.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md text-center py-12",children:(0,o.jsx)("p",{className:"text-gray-500",children:"Nenhum membro encontrado para os filtros selecionados."})}):(0,o.jsx)("div",{className:"space-y-8",children:Object.values(j).map(e=>(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,o.jsxs)("div",{className:"bg-blue-50 p-4 border-b border-blue-100",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:e.nome}),(0,o.jsx)("p",{className:"text-gray-600 mt-1",children:e.descricao||"Sem descri\xe7\xe3o dispon\xedvel"}),e.area_atuacao&&(0,o.jsxs)("div",{className:"mt-2 text-sm",children:[(0,o.jsx)("span",{className:"text-gray-700",children:"\xc1reas de atua\xe7\xe3o: "}),(0,o.jsx)("span",{className:"text-gray-600",children:e.area_atuacao})]})]}),(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cargo"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Inscri\xe7\xe3o OAB"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data de Ingresso"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.membros.map(e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.membro_nome})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-500",children:e.cargo||"-"})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"text-sm text-gray-500",children:[e.email&&(0,o.jsx)("div",{children:e.email}),e.telefone&&(0,o.jsx)("div",{children:e.telefone}),!e.email&&!e.telefone&&"-"]})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-500",children:e.inscricao_oab||"-"})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-500",children:e.data_ingresso?new Date(e.data_ingresso).toLocaleDateString("pt-BR"):"-"})})]},e.membro_id))})]})})]},e.id))})]})}function d(){return(0,o.jsx)(r.Suspense,{fallback:(0,o.jsx)("div",{children:"Carregando..."}),children:(0,o.jsx)(n,{})})}},4933:function(e,s,a){"use strict";a.d(s,{h:function(){return i}});let o="".concat("https://qnsbjljmnflihwcovuwz.supabase.co","/rest/v1"),r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFuc2JqbGptbmZsaWh3Y292dXd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY5NjcyNjQsImV4cCI6MjA2MjU0MzI2NH0.UWGXOyL8J7e11W_CE3zIo5bn-5LwKQ1YtAS1V72DTtk",t={Authorization:"Bearer ".concat(r),apikey:r,"Content-Type":"application/json"},i={getComissoes:async()=>{let e=await fetch("".concat(o,"/comissoes?select=*&order=nome"),{headers:t});if(!e.ok)throw Error("Erro ao carregar comiss\xf5es");return{data:await e.json()}},getProjetos:async()=>{let e=await fetch("".concat(o,"/view_projetos_comissoes?select=*"),{headers:t});if(!e.ok)throw Error("Erro ao carregar projetos");let s=await e.json(),a={};return s.forEach(e=>{a[e.projeto_id]||(a[e.projeto_id]={id:e.projeto_id,nome:e.projeto_nome,descricao:e.projeto_descricao,status:e.projeto_status,objetivos:e.objetivos,publico_alvo:e.publico_alvo,data_inicio:e.data_inicio,data_fim_prevista:e.data_fim_prevista,comissoes:[]}),a[e.projeto_id].comissoes.push({id:e.comissao_id,nome:e.comissao_nome,descricao:e.comissao_descricao,papel:e.papel_comissao})}),{data:Object.values(a)}},getProjeto:async e=>{let s=await fetch("".concat(o,"/projetos?id=eq.").concat(e,"&select=*"),{headers:t});if(!s.ok)throw Error("Erro ao carregar detalhes do projeto");let a=await s.json();if(0===a.length)throw Error("Projeto n\xe3o encontrado");let r=await fetch("".concat(o,"/projetos_comissoes?projeto_id=eq.").concat(e,"&select=papel_comissao,comissoes:comissoes(id,nome,descricao,area_atuacao)"),{headers:t});if(!r.ok)throw Error("Erro ao carregar comiss\xf5es do projeto");let i=await r.json(),c=await fetch("".concat(o,"/tags_projetos?projeto_id=eq.").concat(e,"&select=tag"),{headers:t});if(!c.ok)throw Error("Erro ao carregar tags do projeto");let n=await c.json();return{data:{...a[0],comissoes:i.map(e=>({papel:e.papel_comissao,...e.comissoes})),tags:n.map(e=>e.tag)}}},getSugestoesIntegracao:async e=>{let s=await fetch("".concat(o,"/rpc/sugerir_integracao_projetos"),{method:"POST",headers:t,body:JSON.stringify({projeto_id:e})});if(!s.ok)throw Error("Erro ao carregar sugest\xf5es de integra\xe7\xe3o");return{data:await s.json()}},getMembros:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s="".concat(o,"/view_membros_comissoes?select=*");e&&(s+="&comissao_id=eq.".concat(e)),s+="&order=comissao_nome,membro_nome";let a=await fetch(s,{headers:t});if(!a.ok)throw Error("Erro ao carregar membros");return{data:await a.json()}},buscar:async e=>{let s=await fetch("".concat(o,"/rpc/buscar_projetos_e_comissoes"),{method:"POST",headers:t,body:JSON.stringify({termo:e})});if(!s.ok)throw Error("Erro ao realizar busca");return{data:await s.json()}},criarProjeto:async e=>{let{nome:s,descricao:a,objetivos:r,resultados_esperados:i,publico_alvo:c,data_inicio:n,data_fim_prevista:d,status:m,comissoes:l,tags:h}=e;if(!s||!m||!l||0===l.length)throw Error("Campos obrigat\xf3rios: nome, status e pelo menos uma comiss\xe3o");let p=await fetch("".concat(o,"/projetos"),{method:"POST",headers:{...t,Prefer:"return=representation"},body:JSON.stringify({nome:s,descricao:a,objetivos:r,resultados_esperados:i,publico_alvo:c,data_inicio:n,data_fim_prevista:d,status:m})});if(!p.ok)throw Error((await p.json()).message||"Erro ao criar projeto");let u=await p.json(),x=u[0].id,j=l.map(e=>({projeto_id:x,comissao_id:e.comissao_id,papel_comissao:e.papel_comissao}));if(!(await fetch("".concat(o,"/projetos_comissoes"),{method:"POST",headers:t,body:JSON.stringify(j)})).ok)throw Error("Erro ao relacionar projeto com comiss\xf5es");if(h&&h.length>0){let e=h.map(e=>({projeto_id:x,tag:e}));if(!(await fetch("".concat(o,"/tags_projetos"),{method:"POST",headers:t,body:JSON.stringify(e)})).ok)throw Error("Erro ao adicionar tags ao projeto")}return{data:u[0]}},adicionarMembro:async e=>{let{comissao_id:s,nome:a,cargo:r,email:i,telefone:c,inscricao_oab:n}=e;if(!s||!a)throw Error("Campos obrigat\xf3rios: comissao_id e nome");let d=await fetch("".concat(o,"/membros_comissoes"),{method:"POST",headers:{...t,Prefer:"return=representation"},body:JSON.stringify({comissao_id:s,nome:a,cargo:r,email:i,telefone:c,inscricao_oab:n})});if(!d.ok)throw Error((await d.json()).message||"Erro ao adicionar membro");return{data:(await d.json())[0]}}}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=7322)}),_N_E=e.O()}]);