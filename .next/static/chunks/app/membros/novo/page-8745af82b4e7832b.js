(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[308],{2377:function(e,o,r){Promise.resolve().then(r.bind(r,4626))},9376:function(e,o,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(o,{useParams:function(){return a.useParams}}),r.o(a,"useRouter")&&r.d(o,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(o,{useSearchParams:function(){return a.useSearchParams}})},4626:function(e,o,r){"use strict";r.r(o),r.d(o,{default:function(){return l}});var a=r(7437),s=r(2265),t=r(9376),i=r(7648),c=r(4933);function n(){let e=(0,t.useRouter)(),o=(0,t.useSearchParams)().get("comissao_id"),[r,n]=(0,s.useState)({comissao_id:o||"",nome:"",cargo:"",email:"",telefone:"",inscricao_oab:""}),[l,m]=(0,s.useState)([]),[d,u]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!0),[b,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{p(!0);let{data:e}=await c.h.getComissoes();m(e)}catch(e){console.error("Erro ao carregar comiss\xf5es:",e),f("N\xe3o foi poss\xedvel carregar as comiss\xf5es. Tente novamente mais tarde.")}finally{p(!1)}})()},[]);let g=e=>{let{name:o,value:a}=e.target;n({...r,[o]:a})},j=async o=>{if(o.preventDefault(),!r.nome.trim()){alert("O nome do membro \xe9 obrigat\xf3rio.");return}if(!r.comissao_id){alert("Selecione uma comiss\xe3o.");return}try{u(!0),f(null),await c.h.adicionarMembro(r),alert("Membro adicionado com sucesso!"),e.push("/membros?comissao_id=".concat(r.comissao_id))}catch(e){console.error("Erro ao adicionar membro:",e),f(e.message||"Ocorreu um erro ao adicionar o membro. Tente novamente.")}finally{u(!1)}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(i.default,{href:"/membros",className:"text-blue-600 hover:text-blue-800 mb-2 inline-block",children:"â† Voltar para Membros"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Adicionar Novo Membro"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Preencha o formul\xe1rio abaixo para adicionar um novo membro a uma comiss\xe3o"})]}),b&&(0,a.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",role:"alert",children:(0,a.jsx)("p",{children:b})}),(0,a.jsxs)("form",{onSubmit:j,className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,a.jsx)("label",{htmlFor:"comissao_id",className:"block text-gray-700 font-medium mb-2",children:"Comiss\xe3o *"}),(0,a.jsxs)("select",{id:"comissao_id",name:"comissao_id",value:r.comissao_id,onChange:g,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:h,children:[(0,a.jsx)("option",{value:"",children:"Selecione uma comiss\xe3o"}),l.map(e=>(0,a.jsx)("option",{value:e.id,children:e.nome},e.id))]}),h&&(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Carregando comiss\xf5es..."})]}),(0,a.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,a.jsx)("label",{htmlFor:"nome",className:"block text-gray-700 font-medium mb-2",children:"Nome do Membro *"}),(0,a.jsx)("input",{type:"text",id:"nome",name:"nome",value:r.nome,onChange:g,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"cargo",className:"block text-gray-700 font-medium mb-2",children:"Cargo na Comiss\xe3o"}),(0,a.jsx)("input",{type:"text",id:"cargo",name:"cargo",value:r.cargo,onChange:g,placeholder:"Ex: Presidente, Secret\xe1rio, Membro",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"inscricao_oab",className:"block text-gray-700 font-medium mb-2",children:"Inscri\xe7\xe3o na OAB"}),(0,a.jsx)("input",{type:"text",id:"inscricao_oab",name:"inscricao_oab",value:r.inscricao_oab,onChange:g,placeholder:"Ex: GO12345",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-gray-700 font-medium mb-2",children:"Email"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:r.email,onChange:g,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"telefone",className:"block text-gray-700 font-medium mb-2",children:"Telefone"}),(0,a.jsx)("input",{type:"tel",id:"telefone",name:"telefone",value:r.telefone,onChange:g,placeholder:"Ex: (62) 99999-9999",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)(i.default,{href:"/membros",className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-colors",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors disabled:bg-blue-400",children:d?"Salvando...":"Adicionar Membro"})]})]})]})}function l(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{children:"Carregando..."}),children:(0,a.jsx)(n,{})})}},4933:function(e,o,r){"use strict";r.d(o,{h:function(){return i}});let a="".concat("https://qnsbjljmnflihwcovuwz.supabase.co","/rest/v1"),s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFuc2JqbGptbmZsaWh3Y292dXd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY5NjcyNjQsImV4cCI6MjA2MjU0MzI2NH0.UWGXOyL8J7e11W_CE3zIo5bn-5LwKQ1YtAS1V72DTtk",t={Authorization:"Bearer ".concat(s),apikey:s,"Content-Type":"application/json"},i={getComissoes:async()=>{let e=await fetch("".concat(a,"/comissoes?select=*&order=nome"),{headers:t});if(!e.ok)throw Error("Erro ao carregar comiss\xf5es");return{data:await e.json()}},getProjetos:async()=>{let e=await fetch("".concat(a,"/view_projetos_comissoes?select=*"),{headers:t});if(!e.ok)throw Error("Erro ao carregar projetos");let o=await e.json(),r={};return o.forEach(e=>{r[e.projeto_id]||(r[e.projeto_id]={id:e.projeto_id,nome:e.projeto_nome,descricao:e.projeto_descricao,status:e.projeto_status,objetivos:e.objetivos,publico_alvo:e.publico_alvo,data_inicio:e.data_inicio,data_fim_prevista:e.data_fim_prevista,comissoes:[]}),r[e.projeto_id].comissoes.push({id:e.comissao_id,nome:e.comissao_nome,descricao:e.comissao_descricao,papel:e.papel_comissao})}),{data:Object.values(r)}},getProjeto:async e=>{let o=await fetch("".concat(a,"/projetos?id=eq.").concat(e,"&select=*"),{headers:t});if(!o.ok)throw Error("Erro ao carregar detalhes do projeto");let r=await o.json();if(0===r.length)throw Error("Projeto n\xe3o encontrado");let s=await fetch("".concat(a,"/projetos_comissoes?projeto_id=eq.").concat(e,"&select=papel_comissao,comissoes:comissoes(id,nome,descricao,area_atuacao)"),{headers:t});if(!s.ok)throw Error("Erro ao carregar comiss\xf5es do projeto");let i=await s.json(),c=await fetch("".concat(a,"/tags_projetos?projeto_id=eq.").concat(e,"&select=tag"),{headers:t});if(!c.ok)throw Error("Erro ao carregar tags do projeto");let n=await c.json();return{data:{...r[0],comissoes:i.map(e=>({papel:e.papel_comissao,...e.comissoes})),tags:n.map(e=>e.tag)}}},getSugestoesIntegracao:async e=>{let o=await fetch("".concat(a,"/rpc/sugerir_integracao_projetos"),{method:"POST",headers:t,body:JSON.stringify({projeto_id:e})});if(!o.ok)throw Error("Erro ao carregar sugest\xf5es de integra\xe7\xe3o");return{data:await o.json()}},getMembros:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o="".concat(a,"/view_membros_comissoes?select=*");e&&(o+="&comissao_id=eq.".concat(e)),o+="&order=comissao_nome,membro_nome";let r=await fetch(o,{headers:t});if(!r.ok)throw Error("Erro ao carregar membros");return{data:await r.json()}},buscar:async e=>{let o=await fetch("".concat(a,"/rpc/buscar_projetos_e_comissoes"),{method:"POST",headers:t,body:JSON.stringify({termo:e})});if(!o.ok)throw Error("Erro ao realizar busca");return{data:await o.json()}},criarProjeto:async e=>{let{nome:o,descricao:r,objetivos:s,resultados_esperados:i,publico_alvo:c,data_inicio:n,data_fim_prevista:l,status:m,comissoes:d,tags:u}=e;if(!o||!m||!d||0===d.length)throw Error("Campos obrigat\xf3rios: nome, status e pelo menos uma comiss\xe3o");let h=await fetch("".concat(a,"/projetos"),{method:"POST",headers:{...t,Prefer:"return=representation"},body:JSON.stringify({nome:o,descricao:r,objetivos:s,resultados_esperados:i,publico_alvo:c,data_inicio:n,data_fim_prevista:l,status:m})});if(!h.ok)throw Error((await h.json()).message||"Erro ao criar projeto");let p=await h.json(),b=p[0].id,f=d.map(e=>({projeto_id:b,comissao_id:e.comissao_id,papel_comissao:e.papel_comissao}));if(!(await fetch("".concat(a,"/projetos_comissoes"),{method:"POST",headers:t,body:JSON.stringify(f)})).ok)throw Error("Erro ao relacionar projeto com comiss\xf5es");if(u&&u.length>0){let e=u.map(e=>({projeto_id:b,tag:e}));if(!(await fetch("".concat(a,"/tags_projetos"),{method:"POST",headers:t,body:JSON.stringify(e)})).ok)throw Error("Erro ao adicionar tags ao projeto")}return{data:p[0]}},adicionarMembro:async e=>{let{comissao_id:o,nome:r,cargo:s,email:i,telefone:c,inscricao_oab:n}=e;if(!o||!r)throw Error("Campos obrigat\xf3rios: comissao_id e nome");let l=await fetch("".concat(a,"/membros_comissoes"),{method:"POST",headers:{...t,Prefer:"return=representation"},body:JSON.stringify({comissao_id:o,nome:r,cargo:s,email:i,telefone:c,inscricao_oab:n})});if(!l.ok)throw Error((await l.json()).message||"Erro ao adicionar membro");return{data:(await l.json())[0]}}}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=2377)}),_N_E=e.O()}]);